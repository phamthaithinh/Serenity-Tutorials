(function(e){jQuery.fn.extend({slimScroll:function(i){var r={width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:false,disableFadeOut:false,railVisible:false,railColor:"#333",railOpacity:.2,railDraggable:true,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:false,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"};var a=e.extend(r,i);this.each(function(){var r,s,o,l,n,u,c,h,p="<div></div>",d=30,f=false;var g=e(this);if(g.parent().hasClass(a.wrapperClass)){var v=g.scrollTop();y=g.parent().find("."+a.barClass);m=g.parent().find("."+a.railClass);E();if(e.isPlainObject(i)){if("height"in i&&i.height=="auto"){g.parent().css("height","auto");g.css("height","auto");var b=g.parent().parent().height();g.parent().css("height",b);g.css("height",b)}if("scrollTo"in i){v=parseInt(a.scrollTo)}else if("scrollBy"in i){v+=parseInt(a.scrollBy)}else if("destroy"in i){y.remove();m.remove();g.unwrap();return}H(v,false,true)}return}a.height=i.height=="auto"?g.parent().height():i.height;var w=e(p).addClass(a.wrapperClass).css({position:"relative",overflow:"hidden",width:a.width,height:a.height});g.css({overflow:"hidden",width:a.width,height:a.height});var m=e(p).addClass(a.railClass).css({width:a.size,height:"100%",position:"absolute",top:0,display:a.alwaysVisible&&a.railVisible?"block":"none","border-radius":a.railBorderRadius,background:a.railColor,opacity:a.railOpacity,zIndex:90});var y=e(p).addClass(a.barClass).css({background:a.color,width:a.size,position:"absolute",top:0,opacity:a.opacity,display:a.alwaysVisible?"block":"none","border-radius":a.borderRadius,BorderRadius:a.borderRadius,MozBorderRadius:a.borderRadius,WebkitBorderRadius:a.borderRadius,zIndex:99});var x=a.position=="right"?{right:a.distance}:{left:a.distance};m.css(x);y.css(x);g.wrap(w);g.parent().append(y);g.parent().append(m);if(a.railDraggable){y.bind("mousedown",function(i){var r=e(document);o=true;t=parseFloat(y.css("top"));pageY=i.pageY;r.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY;y.css("top",currTop);H(0,y.position().top,false)});r.bind("mouseup.slimscroll",function(e){o=false;D();r.unbind(".slimscroll")});return false}).bind("selectstart.slimscroll",function(e){e.stopPropagation();e.preventDefault();return false})}m.hover(function(){R()},function(){D()});y.hover(function(){s=true},function(){s=false});g.hover(function(){r=true;R();D()},function(){r=false;D()});g.bind("touchstart",function(e,t){if(e.originalEvent.touches.length){n=e.originalEvent.touches[0].pageY}});g.bind("touchmove",function(e){if(!f){e.originalEvent.preventDefault()}if(e.originalEvent.touches.length){var t=(n-e.originalEvent.touches[0].pageY)/a.touchScrollStep;H(t,true);n=e.originalEvent.touches[0].pageY}});E();if(a.start==="bottom"){y.css({top:g.outerHeight()-y.outerHeight()});H(0,true)}else if(a.start!=="top"){H(e(a.start).position().top,null,true);if(!a.alwaysVisible){y.hide()}}S();function C(t){if(!r){return}var t=t||window.event;var i=0;if(t.wheelDelta){i=-t.wheelDelta/120}if(t.detail){i=t.detail/3}var s=t.target||t.srcTarget||t.srcElement;if(e(s).closest("."+a.wrapperClass).is(g.parent())){H(i,true)}if(t.preventDefault&&!f){t.preventDefault()}if(!f){t.returnValue=false}}function H(e,t,i){f=false;var r=e;var s=g.outerHeight()-y.outerHeight();if(t){r=parseInt(y.css("top"))+e*parseInt(a.wheelStep)/100*y.outerHeight();r=Math.min(Math.max(r,0),s);r=e>0?Math.ceil(r):Math.floor(r);y.css({top:r+"px"})}c=parseInt(y.css("top"))/(g.outerHeight()-y.outerHeight());r=c*(g[0].scrollHeight-g.outerHeight());if(i){r=e;var o=r/g[0].scrollHeight*g.outerHeight();o=Math.min(Math.max(o,0),s);y.css({top:o+"px"})}g.scrollTop(r);g.trigger("slimscrolling",~~r);R();D()}function S(){if(window.addEventListener){this.addEventListener("DOMMouseScroll",C,false);this.addEventListener("mousewheel",C,false)}else{document.attachEvent("onmousewheel",C)}}function E(){u=Math.max(g.outerHeight()/g[0].scrollHeight*g.outerHeight(),d);y.css({height:u+"px"});var e=u==g.outerHeight()?"none":"block";y.css({display:e})}function R(){E();clearTimeout(l);if(c==~~c){f=a.allowPageScroll;if(h!=c){var e=~~c==0?"top":"bottom";g.trigger("slimscroll",e)}}else{f=false}h=c;if(u>=g.outerHeight()){f=true;return}y.stop(true,true).fadeIn("fast");if(a.railVisible){m.stop(true,true).fadeIn("fast")}}function D(){if(!a.alwaysVisible){l=setTimeout(function(){if(!(a.disableFadeOut&&r)&&!s&&!o){y.fadeOut("slow");m.fadeOut("slow")}},1e3)}}});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery);